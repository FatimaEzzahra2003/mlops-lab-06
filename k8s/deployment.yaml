- name: api
  image: churn-api:v1
  ports:
    - containerPort: 8000
  env:
    - name: MODEL_NAME
      valueFrom:
        configMapKeyRef:
          name: churn-config
          key: MODEL_NAME

    - name: LOG_LEVEL
      valueFrom:
        configMapKeyRef:
          name: churn-config
          key: LOG_LEVEL

    - name: MONITORING_TOKEN
      valueFrom:
        secretKeyRef:
          name: churn-secret
          key: MONITORING_TOKEN

  livenessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 10
    periodSeconds: 30

  readinessProbe:
    httpGet:
      path: /ready
      port: 8000
    initialDelaySeconds: 5
    periodSeconds: 10

  startupProbe:
    httpGet:
      path: /startup
      port: 8000
    failureThreshold: 30
    periodSeconds: 5